env:
  - name: DEPLOY_NAMESPACE
    value: jx-staging
pipelineConfig:
  env:
    - name: DEPLOY_NAMESPACE
      value: jx-staging
  pipelines:
    release:
      postBuild:
        steps:
          - name: Wait for services to start
            loop:
              variable: DEPLOYMENT
              values:
                - ps-jx-overidden-pipeline
                - ps-jx-java-quickstart
              steps:
                - command: kubectl
                  args:
                    - rollout
                    - status
                    - deployment
                    - ${DEPLOYMENT}
                    - --namespace=jx-staging
          - name: Run acceptance tests
            command: mvn
            args:
              - "-f"
              - acceptance-tests
              - test
            image: "maven:latest"
